<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
   "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
<meta name="author" content="Ed Arvelaez">
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<!-- <meta charset="utf-8" /> -->
<link id="stylesheetSyntax" rel="stylesheet" media="screen" href="css/shjs_darkblue.css">
<title>actionengine_js.txt.</title>
</head>
<body>

<table class="sh_javascript sh_sourceCode sh_wide" cellpadding="0px" cellspacing="0px"><tbody><tr><td class="sh_linenumber">1</td><td class="sh_syntax"><code><span class="sh_comment">/*</span></code></td></tr><tr><td class="sh_linenumber">2</td><td class="sh_syntax sh_linebetween"><code><span class="sh_comment"> * actionengine.js lics Game Demo</span></code></td></tr><tr><td class="sh_linenumber">3</td><td class="sh_syntax"><code><span class="sh_comment"> * Version 0.1.1, 09/22/2014</span></code></td></tr><tr><td class="sh_linenumber">4</td><td class="sh_syntax sh_linebetween"><code><span class="sh_comment"> * Written by Ed Arvelaez</span></code></td></tr><tr><td class="sh_linenumber">5</td><td class="sh_syntax"><code><span class="sh_comment"> *</span></code></td></tr><tr><td class="sh_linenumber">6</td><td class="sh_syntax sh_linebetween"><code><span class="sh_comment"> * Small showcase of an HTML+JavaScript game</span></code></td></tr><tr><td class="sh_linenumber">7</td><td class="sh_syntax"><code><span class="sh_comment"> */</span></code></td></tr><tr><td class="sh_linenumber">8</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">9</td><td class="sh_syntax"><code>ActionState <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">10</td><td class="sh_syntax sh_linebetween"><code>  Ready <span class="sh_symbol">:</span> <span class="sh_number">0</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">11</td><td class="sh_syntax"><code>  Running <span class="sh_symbol">:</span> <span class="sh_number">1</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">12</td><td class="sh_syntax sh_linebetween"><code>  PauseRequested <span class="sh_symbol">:</span> <span class="sh_number">2</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">13</td><td class="sh_syntax"><code>  Paused <span class="sh_symbol">:</span> <span class="sh_number">3</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">14</td><td class="sh_syntax sh_linebetween"><code>  AbortRequested <span class="sh_symbol">:</span> <span class="sh_number">4</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">15</td><td class="sh_syntax"><code>  Aborted <span class="sh_symbol">:</span> <span class="sh_number">5</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">16</td><td class="sh_syntax sh_linebetween"><code>  Finished <span class="sh_symbol">:</span> <span class="sh_number">6</span></code></td></tr><tr><td class="sh_linenumber">17</td><td class="sh_syntax"><code><span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">18</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">19</td><td class="sh_syntax"><code><span class="sh_keyword">var</span> ActionEngine <span class="sh_symbol">=</span> <span class="sh_keyword">null</span> <span class="sh_symbol">,</span> Action <span class="sh_symbol">=</span> <span class="sh_keyword">null</span> <span class="sh_symbol">,</span> ShowPathAction <span class="sh_symbol">=</span> <span class="sh_keyword">null</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">20</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">21</td><td class="sh_syntax"><code><span class="sh_symbol">(</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">22</td><td class="sh_syntax sh_linebetween"><code><span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">23</td><td class="sh_syntax"><code>  </code></td></tr><tr><td class="sh_linenumber">24</td><td class="sh_syntax sh_linebetween"><code>ActionEngine <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pInterval <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">25</td><td class="sh_syntax"><code><span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">26</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions <span class="sh_symbol">=</span> <span class="sh_symbol">[]</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">27</td><td class="sh_syntax"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finishedActionIndices <span class="sh_symbol">=</span> <span class="sh_symbol">[]</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">28</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">=</span> <span class="sh_keyword">null</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">29</td><td class="sh_syntax"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>interval <span class="sh_symbol">=</span> pInterval <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">30</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">31</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">32</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>start <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">33</td><td class="sh_syntax"><code>  <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">34</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">===</span> <span class="sh_keyword">null</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">35</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">36</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">37</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">38</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">39</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">40</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>stop <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">41</td><td class="sh_syntax"><code>  <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">42</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">!==</span> <span class="sh_keyword">null</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">43</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">44</td><td class="sh_syntax sh_linebetween"><code>      window<span class="sh_symbol">.</span><span class="sh_function">clearTimeout</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">45</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">46</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">47</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">48</td><td class="sh_syntax sh_linebetween"><code>  </code></td></tr><tr><td class="sh_linenumber">49</td><td class="sh_syntax"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>run <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">50</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">51</td><td class="sh_syntax"><code>    <span class="sh_keyword">var</span> startTime <span class="sh_symbol">=</span> <span class="sh_symbol">(</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Date</span><span class="sh_symbol">()).</span><span class="sh_function">getTime</span><span class="sh_symbol">()</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">52</td><td class="sh_syntax sh_linebetween"><code>        actionCount <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions<span class="sh_symbol">.</span>length <span class="sh_symbol">,</span> ii <span class="sh_symbol">,</span> currentAction <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">53</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">54</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span> ii <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> ii <span class="sh_symbol">&lt;</span> actionCount <span class="sh_symbol">;</span> ii <span class="sh_symbol">++</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">55</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">56</td><td class="sh_syntax sh_linebetween"><code>      currentAction <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions<span class="sh_symbol">[</span> ii <span class="sh_symbol">]</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">57</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">58</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">===</span> ActionState<span class="sh_symbol">.</span>Ready <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">59</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">60</td><td class="sh_syntax sh_linebetween"><code>        currentAction<span class="sh_symbol">.</span><span class="sh_function">initialize</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">61</td><td class="sh_syntax"><code>        currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">=</span> ActionState<span class="sh_symbol">.</span>Running <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">62</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">63</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">64</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">===</span> ActionState<span class="sh_symbol">.</span>PauseRequested <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">65</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">66</td><td class="sh_syntax sh_linebetween"><code>        currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">=</span> ActionState<span class="sh_symbol">.</span>Paused <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">67</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">68</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">===</span> ActionState<span class="sh_symbol">.</span>Running <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">69</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">70</td><td class="sh_syntax sh_linebetween"><code>        currentAction<span class="sh_symbol">.</span><span class="sh_function">step</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">71</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">72</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">73</td><td class="sh_syntax"><code>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">===</span> ActionState<span class="sh_symbol">.</span>AbortRequested <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">74</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">75</td><td class="sh_syntax"><code>        currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">=</span> ActionState<span class="sh_symbol">.</span>Aborted <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">76</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finishedActionIndices<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span> ii <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">77</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">78</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">else</span> <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> currentAction<span class="sh_symbol">.</span><span class="sh_function">done</span><span class="sh_symbol">())</span></code></td></tr><tr><td class="sh_linenumber">79</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">80</td><td class="sh_syntax sh_linebetween"><code>        currentAction<span class="sh_symbol">.</span>state <span class="sh_symbol">=</span> ActionState<span class="sh_symbol">.</span>Finished <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">81</td><td class="sh_syntax"><code>        currentAction<span class="sh_symbol">.</span><span class="sh_function">finalize</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">82</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finishedActionIndices<span class="sh_symbol">.</span><span class="sh_function">push</span><span class="sh_symbol">(</span> ii <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">83</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">84</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">85</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">86</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">var</span> actionFinishedIndex <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">87</td><td class="sh_syntax"><code>    <span class="sh_keyword">while</span> <span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finishedActionIndices<span class="sh_symbol">.</span>length <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">88</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">89</td><td class="sh_syntax"><code>      actionFinishedIndex <span class="sh_symbol">=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finishedActionIndices<span class="sh_symbol">.</span><span class="sh_function">pop</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">90</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions<span class="sh_symbol">.</span><span class="sh_function">splice</span><span class="sh_symbol">(</span> actionFinishedIndex <span class="sh_symbol">,</span> <span class="sh_number">1</span> <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">91</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">92</td><td class="sh_syntax sh_linebetween"><code>    </code></td></tr><tr><td class="sh_linenumber">93</td><td class="sh_syntax"><code>    console<span class="sh_symbol">.</span><span class="sh_function">log</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">94</td><td class="sh_syntax sh_linebetween"></td></tr><tr><td class="sh_linenumber">95</td><td class="sh_syntax"><code>    <span class="sh_keyword">var</span> elapsedTime <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">96</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>actions<span class="sh_symbol">.</span>length <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">97</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">98</td><td class="sh_syntax sh_linebetween"><code>      elapsedTime <span class="sh_symbol">=</span> <span class="sh_symbol">(</span> <span class="sh_keyword">new</span> <span class="sh_predef_func">Date</span><span class="sh_symbol">()).</span><span class="sh_function">getTime</span><span class="sh_symbol">()</span> <span class="sh_symbol">-</span> startTime <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">99</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">100</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span> elapsedTime <span class="sh_symbol">&gt;=</span> <span class="sh_keyword">this</span><span class="sh_symbol">.</span>interval <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">101</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">102</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">=</span> window<span class="sh_symbol">.</span><span class="sh_function">setTimeout</span><span class="sh_symbol">(</span></code></td></tr><tr><td class="sh_linenumber">103</td><td class="sh_syntax"><code>          <span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pEngine <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">104</td><td class="sh_syntax sh_linebetween"><code>          <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">105</td><td class="sh_syntax"><code>            <span class="sh_keyword">return</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">106</td><td class="sh_syntax sh_linebetween"><code>            <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">107</td><td class="sh_syntax"><code>              pEngine<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">108</td><td class="sh_syntax sh_linebetween"><code>            <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">109</td><td class="sh_syntax"><code>          <span class="sh_cbracket">}</span><span class="sh_symbol">)(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">)</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">110</td><td class="sh_syntax sh_linebetween"><code>          <span class="sh_keyword">this</span><span class="sh_symbol">.</span>interval <span class="sh_symbol">-</span> elapsedTime</code></td></tr><tr><td class="sh_linenumber">111</td><td class="sh_syntax"><code>        <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">112</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">113</td><td class="sh_syntax"><code>      <span class="sh_keyword">else</span></code></td></tr><tr><td class="sh_linenumber">114</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">115</td><td class="sh_syntax"><code>        <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">=</span> window<span class="sh_symbol">.</span><span class="sh_function">setTimeout</span><span class="sh_symbol">(</span></code></td></tr><tr><td class="sh_linenumber">116</td><td class="sh_syntax sh_linebetween"><code>          <span class="sh_symbol">(</span><span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pEngine <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">117</td><td class="sh_syntax"><code>          <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">118</td><td class="sh_syntax sh_linebetween"><code>            <span class="sh_keyword">return</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">119</td><td class="sh_syntax"><code>            <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">120</td><td class="sh_syntax sh_linebetween"><code>              pEngine<span class="sh_symbol">.</span><span class="sh_function">run</span><span class="sh_symbol">()</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">121</td><td class="sh_syntax"><code>            <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">122</td><td class="sh_syntax sh_linebetween"><code>          <span class="sh_cbracket">}</span><span class="sh_symbol">)(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">)</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">123</td><td class="sh_syntax"><code>          <span class="sh_keyword">this</span><span class="sh_symbol">.</span>interval</code></td></tr><tr><td class="sh_linenumber">124</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">125</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">126</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">127</td><td class="sh_syntax"><code>    <span class="sh_keyword">else</span></code></td></tr><tr><td class="sh_linenumber">128</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">129</td><td class="sh_syntax"><code>      <span class="sh_keyword">this</span><span class="sh_symbol">.</span>timeoutId <span class="sh_symbol">=</span> <span class="sh_keyword">null</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">130</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">131</td><td class="sh_syntax"><code>  <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">132</td><td class="sh_syntax sh_linebetween"><code><span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">133</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">134</td><td class="sh_syntax sh_linebetween"><code><span class="sh_keyword">var</span> _handlerCreator <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pThis <span class="sh_symbol">,</span> pHandler <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">135</td><td class="sh_syntax"><code><span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">136</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">return</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">137</td><td class="sh_syntax"><code>  <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">138</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">return</span> <span class="sh_function">pHandler</span><span class="sh_symbol">(</span> pThis <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">139</td><td class="sh_syntax"><code>  <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">140</td><td class="sh_syntax sh_linebetween"><code><span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">141</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">142</td><td class="sh_syntax sh_linebetween"><code>Action <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span></code></td></tr><tr><td class="sh_linenumber">143</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">144</td><td class="sh_syntax sh_linebetween"><code>  pInitialize <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">145</td><td class="sh_syntax"><code>  pStep <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">146</td><td class="sh_syntax sh_linebetween"><code>  pFinalize <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">147</td><td class="sh_syntax"><code>  pDone</code></td></tr><tr><td class="sh_linenumber">148</td><td class="sh_syntax sh_linebetween"><code><span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">149</td><td class="sh_syntax"><code><span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">150</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>state <span class="sh_symbol">=</span> ActionState<span class="sh_symbol">.</span>Ready <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">151</td><td class="sh_syntax"><code>  </code></td></tr><tr><td class="sh_linenumber">152</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>initialize <span class="sh_symbol">=</span> pInitialize <span class="sh_symbol">?</span> <span class="sh_function">_handlerCreator</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">,</span> pInitialize <span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">153</td><td class="sh_syntax"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>step <span class="sh_symbol">=</span> pStep <span class="sh_symbol">?</span> <span class="sh_function">_handlerCreator</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">,</span> pStep <span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">154</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>finalize <span class="sh_symbol">=</span> pFinalize <span class="sh_symbol">?</span> <span class="sh_function">_handlerCreator</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">,</span> pFinalize <span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">155</td><td class="sh_syntax"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>done <span class="sh_symbol">=</span> pDone <span class="sh_symbol">?</span> <span class="sh_function">_handlerCreator</span><span class="sh_symbol">(</span> <span class="sh_keyword">this</span> <span class="sh_symbol">,</span> pDone <span class="sh_symbol">)</span> <span class="sh_symbol">:</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> <span class="sh_symbol">)</span> <span class="sh_cbracket">{</span> <span class="sh_keyword">return</span> <span class="sh_keyword">true</span> <span class="sh_symbol">;</span> <span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">156</td><td class="sh_syntax sh_linebetween"><code><span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">157</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">158</td><td class="sh_syntax sh_linebetween"><code>ShowPathAction <span class="sh_symbol">=</span> <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pTime <span class="sh_symbol">,</span> pPath <span class="sh_symbol">,</span> pTable <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">159</td><td class="sh_syntax"><code><span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">160</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span>base <span class="sh_symbol">=</span> Action <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">161</td><td class="sh_syntax"><code>  </code></td></tr><tr><td class="sh_linenumber">162</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_keyword">this</span><span class="sh_symbol">.</span><span class="sh_function">base</span><span class="sh_symbol">(</span></code></td></tr><tr><td class="sh_linenumber">163</td><td class="sh_syntax"><code>    <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pAction <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">164</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">165</td><td class="sh_syntax"><code>      pAction<span class="sh_symbol">.</span>counter <span class="sh_symbol">=</span> pTime <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">166</td><td class="sh_syntax sh_linebetween"><code>      pAction<span class="sh_symbol">.</span>path <span class="sh_symbol">=</span> pPath <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">167</td><td class="sh_syntax"><code>      pAction<span class="sh_symbol">.</span>table <span class="sh_symbol">=</span> pTable <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">168</td><td class="sh_syntax sh_linebetween"><code>      pAction<span class="sh_symbol">.</span>colored <span class="sh_symbol">=</span> <span class="sh_keyword">false</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">169</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">170</td><td class="sh_syntax sh_linebetween"><code>    </code></td></tr><tr><td class="sh_linenumber">171</td><td class="sh_syntax"><code>    <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pAction <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">172</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">173</td><td class="sh_syntax"><code>      <span class="sh_keyword">var</span> ii <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">174</td><td class="sh_syntax sh_linebetween"><code>      </code></td></tr><tr><td class="sh_linenumber">175</td><td class="sh_syntax"><code>      <span class="sh_keyword">if</span> <span class="sh_symbol">((</span> pAction<span class="sh_symbol">.</span>counter <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span> <span class="sh_symbol">)</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_symbol">(</span> <span class="sh_symbol">!</span> pAction<span class="sh_symbol">.</span>colored <span class="sh_symbol">))</span></code></td></tr><tr><td class="sh_linenumber">176</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">177</td><td class="sh_syntax"><code>        <span class="sh_keyword">for</span> <span class="sh_symbol">(</span> ii <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> ii <span class="sh_symbol">&lt;</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">.</span>length <span class="sh_symbol">;</span> ii <span class="sh_symbol">++</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">178</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">179</td><td class="sh_syntax"><code>          pAction<span class="sh_symbol">.</span>table<span class="sh_symbol">.</span>rows<span class="sh_symbol">[</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">[</span> ii <span class="sh_symbol">].</span>row <span class="sh_symbol">].</span>cells<span class="sh_symbol">[</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">[</span> ii <span class="sh_symbol">].</span>column <span class="sh_symbol">].</span>className <span class="sh_symbol">=</span> <span class="sh_string">'path'</span> <span class="sh_symbol">;</span> </code></td></tr><tr><td class="sh_linenumber">180</td><td class="sh_syntax sh_linebetween"><code>        <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">181</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">182</td><td class="sh_syntax sh_linebetween"><code>      </code></td></tr><tr><td class="sh_linenumber">183</td><td class="sh_syntax"><code>      pAction<span class="sh_symbol">.</span>colored <span class="sh_symbol">=</span> <span class="sh_keyword">true</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">184</td><td class="sh_syntax sh_linebetween"><code>      pAction<span class="sh_symbol">.</span>counter <span class="sh_symbol">--</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">185</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">186</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pAction <span class="sh_symbol">)</span> </code></td></tr><tr><td class="sh_linenumber">187</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">188</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">var</span> ii <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">189</td><td class="sh_syntax"></td></tr><tr><td class="sh_linenumber">190</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">for</span> <span class="sh_symbol">(</span> ii <span class="sh_symbol">=</span> <span class="sh_number">0</span> <span class="sh_symbol">;</span> ii <span class="sh_symbol">&lt;</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">.</span>length <span class="sh_symbol">;</span> ii <span class="sh_symbol">++</span> <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">191</td><td class="sh_syntax"><code>      <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">192</td><td class="sh_syntax sh_linebetween"><code>        pAction<span class="sh_symbol">.</span>table<span class="sh_symbol">.</span>rows<span class="sh_symbol">[</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">[</span> ii <span class="sh_symbol">].</span>row <span class="sh_symbol">].</span>cells<span class="sh_symbol">[</span> pAction<span class="sh_symbol">.</span>path<span class="sh_symbol">[</span> ii <span class="sh_symbol">].</span>column <span class="sh_symbol">].</span>className <span class="sh_symbol">=</span> <span class="sh_string">'portrait'</span> <span class="sh_symbol">;</span> </code></td></tr><tr><td class="sh_linenumber">193</td><td class="sh_syntax"><code>      <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">194</td><td class="sh_syntax sh_linebetween"><code>      </code></td></tr><tr><td class="sh_linenumber">195</td><td class="sh_syntax"><code>      pAction<span class="sh_symbol">.</span>counter <span class="sh_symbol">=</span> pTime <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">196</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_cbracket">}</span> <span class="sh_symbol">,</span></code></td></tr><tr><td class="sh_linenumber">197</td><td class="sh_syntax"><code>    </code></td></tr><tr><td class="sh_linenumber">198</td><td class="sh_syntax sh_linebetween"><code>    <span class="sh_keyword">function</span> <span class="sh_symbol">(</span> pAction <span class="sh_symbol">)</span></code></td></tr><tr><td class="sh_linenumber">199</td><td class="sh_syntax"><code>    <span class="sh_cbracket">{</span></code></td></tr><tr><td class="sh_linenumber">200</td><td class="sh_syntax sh_linebetween"><code>      <span class="sh_keyword">return</span> <span class="sh_symbol">(</span> pAction<span class="sh_symbol">.</span>counter <span class="sh_symbol">&lt;</span> <span class="sh_number">1</span> <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">201</td><td class="sh_syntax"><code>    <span class="sh_cbracket">}</span></code></td></tr><tr><td class="sh_linenumber">202</td><td class="sh_syntax sh_linebetween"><code>  <span class="sh_symbol">)</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">203</td><td class="sh_syntax"><code><span class="sh_cbracket">}</span> <span class="sh_symbol">;</span></code></td></tr><tr><td class="sh_linenumber">204</td><td class="sh_syntax sh_linebetween"><code>  </code></td></tr><tr><td class="sh_linenumber">205</td><td class="sh_syntax"><code>  </code></td></tr><tr><td class="sh_linenumber">206</td><td class="sh_syntax sh_linebetween"><code><span class="sh_cbracket">}</span><span class="sh_symbol">)()</span> <span class="sh_symbol">;</span></code></td></tr></tbody></table>


</body></html>